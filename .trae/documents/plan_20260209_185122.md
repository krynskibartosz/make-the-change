Ce plan vise à transformer votre base de données vers une convention **"Clean Domain"**, plus moderne et lisible, en éliminant les suffixes techniques (`_enum`, `_type`, `_v2`).

## **Phase 1 : Audit des Collisions (Lecture seule)**
1.  **Vérification des conflits** : S'assurer qu'en supprimant les suffixes (ex: `order_status_enum` -> `order_status`), on ne crée pas de collision avec une table existante (très peu probable ici).
2.  **Mapping des renommages** : Préparer la liste cible :
    - `order_status_enum` → `order_status`
    - `payment_method_enum` → `payment_method`
    - `subscription_status_type` → `subscription_status`
    - `subscription_plan_enum_v2` → `subscription_plan`
    - `user_level_enum` → `user_level`

## **Phase 2 : Migration SQL "Clean Domain"**
1.  **Suppression des redondances** : Éliminer les types obsolètes (ex: `subscription_plan_enum` v1).
2.  **Renommage sémantique** : Appliquer les nouveaux noms sans suffixes techniques.
3.  **Gestion des dépendances** : 
    - Extraire les définitions des vues dépendantes.
    - Supprimer temporairement les vues.
    - Appliquer les changements de types.
    - Recréer les vues en pointant vers les nouveaux noms.

## **Phase 3 : Conversion des "Faux Enums"**
1.  **Standardisation** : Remplacer les colonnes `text + CHECK` par des types énumérés réels avec des noms propres.
    - Créer le type `message_status` (pour `producer_messages`).
    - Créer le type `ledger_reason` (pour `points_ledger`).

## **Phase 4 : Alignement du Code & TypeScript**
1.  **Mise à jour Drizzle** : Nettoyer [schema.ts](file:///Users/bartoszkrynski/Downloads/Development/make-the-change/packages/core/src/shared/db/schema.ts) pour utiliser les noms "Clean Domain".
2.  **Régénération Supabase** : Synchroniser les types TypeScript pour avoir des unions de strings propres (ex: `status: order_status`).

## **Questions pour valider le plan :**
1.  **Convention de nommage** : Êtes-vous d'accord pour supprimer les suffixes `_enum` et `_type` pour une approche plus épurée, ou préférez-vous garder un suffixe pour une identification visuelle immédiate ?
2.  **Gestion des Vues** : Voulez-vous que je génère un script qui gère automatiquement le cycle "Drop View -> Alter -> Recreate" pour éviter de casser la base ?
3.  **Changement de schéma** : Souhaitez-vous que certains enums soient déplacés dans un schéma spécifique (ex: un schéma `types` ou `enums`) pour plus de propreté, ou rester dans leurs schémas métiers respectifs ? (La tendance 2026 est au métier : `commerce.order_status`).